<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="STATE" height="542px" preserveAspectRatio="none" style="width:612px;height:542px;background:#FEFEFE;" version="1.1" viewBox="0 0 612 542" width="612px" zoomAndPan="magnify"><title>Unload State Machine (FF11 Subcmds)</title><defs/><g><rect fill="#FEFEFE" height="542" style="stroke:none;stroke-width:1;" width="612" x="0" y="0"/><g class="title" data-source-line="1"><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="258.2617" x="169.9573" y="23.1318">Unload State Machine (FF11 Subcmds)</text></g><g class="entity" data-entity="N1" data-source-line="5" data-uid="ent0002" id="entity_N1"><path d="M6,43.0986 L6,142.791 L374.8896,142.791 L374.8896,53.0986 L364.8896,43.0986 L6,43.0986" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M364.8896,43.0986 L364.8896,53.0986 L374.8896,53.0986 L364.8896,43.0986" fill="#FEFFDD" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.6563" x="12" y="60.2925">Idiosyncrasies:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.8896" x="12" y="75.2412">- COMPLETE is blocking (~17s) - main retract happens here</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="314.8374" x="12" y="90.1899">- Small "micro-movements" audible before main retract</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298.4033" x="19.2236" y="105.1387">are likely firmware-internal (not exposed in protocol)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.0933" x="12" y="120.0874">- Only evidence would be encoder readings (FF0E)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298.0605" x="12" y="135.0361">- POLLING phases have quick responses (~500ms)</text></g><ellipse cx="420.5" cy="93.0986" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1;"/><g id="POLLING"><rect fill="#F1F1F1" height="63.6963" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="120.043" x="360.5" y="219.0986"/><line style="stroke:#181818;stroke-width:0.5;" x1="360.5" x2="480.543" y1="245.1973" y2="245.1973"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.6895" x="390.1768" y="237.2305">POLLING</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="100.043" x="365.5" y="261.4531">Retracting filament</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="82.0254" x="365.5" y="275.252">Motor: Reverse</text></g><g id="COMPLETE"><rect fill="#F1F1F1" height="63.6963" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="102.0488" x="369.5" y="374.0986"/><line style="stroke:#181818;stroke-width:0.5;" x1="369.5" x2="471.5488" y1="400.1973" y2="400.1973"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.0137" x="382.0176" y="392.2305">COMPLETE</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="81.3691" x="374.5" y="416.4531">Filament in box</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="82.0488" x="374.5" y="430.252">Motor: Stopped</text></g><ellipse cx="420.5" cy="525.0986" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1;"/><ellipse cx="420.5" cy="525.0986" fill="#222222" rx="6" ry="6" style="stroke:#222222;stroke-width:1;"/><!--link *start* to POLLING--><g class="link" data-entity-1=".start." data-entity-2="POLLING" data-source-line="13" data-uid="lnk4" id="link_.start._POLLING"><path d="M420.5,103.3886 C420.5,125.6286 420.5,176.7286 420.5,212.7886" fill="none" id="*start*-to-POLLING" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="420.5,218.7886,424.5,209.7886,420.5,213.7886,416.5,209.7886,420.5,218.7886" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.0254" x="421.5" y="186.2925">FF11 xx 00</text></g><!--link POLLING to POLLING--><g class="link" data-entity-1="POLLING" data-entity-2="POLLING" data-source-line="15" data-uid="lnk5" id="link_POLLING_POLLING"><path d="M480.8,237.9786 C500.16,238.1086 515.5,242.4886 515.5,251.0986 C515.5,259.7086 506.1599,264.0483 486.7999,264.1783" fill="none" id="POLLING-to-POLLING" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="480.8,264.2186,489.8267,268.1581,485.7999,264.1851,489.7729,260.1583,480.8,264.2186" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.1309" x="529.2727" y="248.7925">Every 5-7s</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.6763" x="521.5" y="263.7412">status=BUSY</text></g><!--link POLLING to COMPLETE--><g class="link" data-entity-1="POLLING" data-entity-2="COMPLETE" data-source-line="16" data-uid="lnk7" id="link_POLLING_COMPLETE"><path d="M420.5,283.4286 C420.5,309.9186 420.5,341.6686 420.5,368.0686" fill="none" id="POLLING-to-COMPLETE" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="420.5,374.0686,424.5,365.0686,420.5,369.0686,416.5,365.0686,420.5,374.0686" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.0254" x="427.2827" y="326.2925">FF11 xx 01</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.5908" x="421.5" y="341.2412">(10-23s total)</text></g><!--link COMPLETE to *end*--><g class="link" data-entity-1="COMPLETE" data-entity-2=".end." data-source-line="20" data-uid="lnk9" id="link_COMPLETE_.end."><path d="M420.5,438.1486 C420.5,463.3286 420.5,491.2886 420.5,507.9786" fill="none" id="COMPLETE-to-*end*" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="420.5,513.9786,424.5,504.9786,420.5,508.9786,416.5,504.9786,420.5,513.9786" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.0581" x="421.5" y="481.2925">status=OK</text></g><!--SRC=[LL5DRzim3BthLn3TnJ5WmDvG50Ym7LOuGx6aAURsCAmxq1RJ2955JvBJvDBVFYhDiWGwYUJxu6CqqH8yESkeeOaO2HROhOqZo6Qpge9cRBjUXuaA6-C6zDX3YztcnVFez2rRzl1XLgUdb6E1Ou3xIW7a-Pqs7FQkynWCXMcUIxM0s-NYOLu_rc02j9OxeNs1xAsw2HFfzcWSU8eUkmXh70Po0TRawO1jUhGMhdhJUIvwtb9FBeOhm56RLlPeQSMUBaW41u1Ij6P3TWyhu_jN-HV6HV8EBMHY6sWtS20D0XmyH-xOJWwIIoSWsXfDhYDuvT5gaG7viIOlAgXbWP3IAkjtoCDoFh-x_mR36WE9UzmI_1bDjv7fCB1BnUpjkYnxYPMSXfIRKh_otr0KNqxmAHmEiDj1MIhrhtevKM_9x-6wk0dFBiZrnl3vwrFpysBw5FWPOVNiigeiFduA43cYxFgVyyTxSEaiAsCnHNpMNKWuFWs9SX3N9_OabLQOmj78yhiwbpvIfOHRtfstZfHDP3ctLdy1]--></g></svg>